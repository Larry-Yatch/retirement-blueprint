# Profile Testing Summary

## Key Findings

### 1. ✅ SOLVED: "Allocation Calculation Issue"
**Not a bug!** The system enforces a minimum 20% savings rate (`CONFIG.OPTIMIZED_SAVINGS_RATE`).
- When users request < 20%, system allocates 20% minimum
- This is a good feature for retirement security
- Tests need to account for this minimum

### 2. ✅ SOLVED: Profile 4 Missing 401(k) 
**Fixed!** The issue was incorrect form question mapping:
- Profile 4 uses ex_q5-8 for IRA/backdoor questions
- Uses ex_q1-4 for employer 401(k) questions
- After fixing the test data mapping, 401(k) vehicles now appear

### 3. ⚠️ ISSUE: Backdoor Roth IRA Not Allocated
**Problem:** Profile 4 helper generates Backdoor Roth IRA correctly, but engine doesn't allocate to it
**Cause:** Limited retirement domain budget ($1,100) is exhausted before reaching Backdoor Roth:
1. 401(k) Match: $667
2. 401(k) Roth: $433
3. Total: $1,100 (exhausted)
4. Backdoor Roth IRA: $0 (no funds left)

**Solution Options:**
1. Increase test allocation percentage to provide more budget
2. Adjust vehicle priority order
3. Accept current behavior as correct (match and 401k are higher priority)

### 4. ⚠️ ISSUE: Profile 7 Missing 401(k) Vehicles
**Status:** Still investigating - appears to be a different issue than Profile 4

## Test Status

### Profile 2 (ROBS Curious) ✅
- Fully working with dynamic vehicle selection
- Correctly handles W-2 and self-employed scenarios
- Monthly allocations accurate

### Profile 4 (Roth Reclaimer) ⚠️
- Employer 401(k) integration working ✅
- Form question mapping fixed ✅
- Backdoor Roth generation working ✅
- Backdoor Roth allocation limited by budget ⚠️
- Consider this acceptable behavior

### Profile 7 (Foundation Builder) ❌
- Still showing issues with 401(k) vehicles
- Needs further investigation

## Recommendations

1. **For Profile 4:** Consider the current behavior acceptable. The system correctly prioritizes employer match and 401(k) contributions over Backdoor Roth IRA, which is appropriate.

2. **For Profile 7:** Debug why employer 401(k) vehicles aren't appearing in allocations despite being generated by the helper.

3. **For Testing:** Always account for the 20% minimum savings rate when setting expected values.

4. **Documentation:** Add user-facing documentation about the 20% minimum savings rate feature.